generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum UserRole {
  ADMIN
  USER
  MODERATOR
}

enum UserStatus {
  ACTIVE
  INACTIVE
  PENDING
  SUSPENDED
}

model User {
  id        String     @id @default(cuid())
  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt

  // === Privy Authentication ===
  privyId       String    @unique
  privyDid      String?   @unique

  // === Ethos Core Fields (READ-ONLY) ===
  ethosProfileId    Int?      @unique
  ethosUserId       Int?      @unique
  ethosUsername     String?
  ethosDisplayName  String?
  ethosAvatarUrl    String?
  ethosDescription  String?   @db.Text
  ethosScore        Int?                    // Credibility score (0-2000)
  ethosStatus       String?                 // ACTIVE, INACTIVE, etc.

  // === Ethos Social Accounts (READ-ONLY) ===
  ethosXHandle      String?                 // Twitter/X username
  ethosXId          String?                 // Twitter/X numeric ID
  ethosDiscordId    String?
  ethosFarcasterId  String?
  ethosTelegramId   String?

  // === Ethos Wallets (READ-ONLY) ===
  ethosPrimaryWallet String?               // Primary Ethereum address
  ethosWallets       String[]              // All linked wallets

  // === Ethos Stats (READ-ONLY) ===
  ethosXpTotal           Int?
  ethosXpStreakDays      Int?
  ethosInfluenceFactor   Float?
  ethosInfluencePercentile Float?

  // === Ethos Raw Data (READ-ONLY) ===
  ethosRawData      Json?                  // Full API response backup
  ethosUserkeys     String[]               // All userkey identifiers
  ethosLastSyncedAt DateTime?

  // === App-Specific (Editable) ===
  email             String?
  customDisplayName String?                // User can override display name
  preferences       Json?

  // === System ===
  role      UserRole   @default(USER)
  status    UserStatus @default(ACTIVE)

  @@index([ethosProfileId])
  @@index([ethosPrimaryWallet])
  @@index([ethosXHandle])
}
